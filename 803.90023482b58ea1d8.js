"use strict";(self.webpackChunkmedhead=self.webpackChunkmedhead||[]).push([[803],{4803:(j,f,o)=>{o.r(f),o.d(f,{UrgencesModule:()=>Q});var p=o(6895),a=o(433),y=o(2687),t=o(1571),Z=o(1481),S=o(4440),A=o(6626),O=o(881),R=o(529);let U=(()=>{class e{constructor(n){this.httpClient=n}getRecommandation(n,i,c){return this.httpClient.post(O.F+"getRecommandations",{specID:c,latitude:n,longitude:i})}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(R.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=o(2216),u=o(9549),F=o(3238),v=o(4859),x=o(1572),g=o(3805),C=o(4144);function T(e,s){1&e&&(t.TgZ(0,"div",3),t._UZ(1,"mat-spinner",4),t.qZA())}function L(e,s){if(1&e&&(t.TgZ(0,"div",17),t._UZ(1,"fa-icon",18),t._uU(2),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("icon",n.faLocation),t.xp6(1),t.hij(" Votre position: ",n.currentPosition," ")}}function M(e,s){if(1&e&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&e){const n=s.$implicit;t.Q6J("value",n.name),t.xp6(1),t.hij(" ",n.name," ")}}function I(e,s){if(1&e&&(t.TgZ(0,"div",20)(1,"h1"),t._uU(2),t.qZA(),t._UZ(3,"iframe",21),t.qZA()),2&e){const n=t.oxw(2);t.xp6(2),t.hij("Le centre le plus proche est ",n.recommandations[0].hopital.name,""),t.xp6(1),t.Q6J("src",n.mapLink,t.uOi)}}function J(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",5)(1,"div",6),t.YNc(2,L,3,2,"div",7),t.TgZ(3,"div",8)(4,"form",9)(5,"mat-form-field",10)(6,"mat-label"),t._uU(7,"Nom du patient"),t.qZA(),t._UZ(8,"input",11),t.qZA(),t.TgZ(9,"mat-form-field",10)(10,"mat-label"),t._uU(11,"Sp\xe9cialit\xe9"),t.qZA(),t._UZ(12,"input",12),t.TgZ(13,"mat-autocomplete",null,13),t.YNc(15,M,2,2,"mat-option",14),t.qZA()(),t.TgZ(16,"button",15),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.getRecommandations())}),t._uU(17,"Rechercher"),t.qZA()()()(),t.YNc(18,I,4,2,"div",16),t.qZA()}if(2&e){const n=t.MAs(14),i=t.oxw();t.xp6(2),t.Q6J("ngIf",i.currentPosition),t.xp6(2),t.Q6J("formGroup",i.emergencyForm),t.xp6(8),t.Q6J("matAutocomplete",n),t.xp6(3),t.Q6J("ngForOf",i.specOptions),t.xp6(3),t.Q6J("ngIf",i.recommandations.length>0)}}let P=(()=>{class e{constructor(n,i,c,l,m){this.sanitizer=n,this.addresseService=i,this.formBuilder=c,this.specService=l,this.recommandationService=m,this.mapLink=null,this.faLocation=y.iUi,this.allSpecs=[],this.specOptions=[],this.recommandations=[],this.emergencyForm=this.formBuilder.group({patient:["",a.kI.required],specialite:["",a.kI.required]}),this.getAllSpecs(),this.emergencyForm.get("specialite").valueChanges.subscribe(r=>{this.specOptions=this.allSpecs.filter(d=>d.name.includes(r))}),navigator.geolocation.getCurrentPosition(r=>{this.latitude=r.coords.latitude,this.longitude=r.coords.longitude,this.isLocationLoading=!0,this.addresseService.getAddressByCoordinates(this.latitude,this.longitude).subscribe(d=>{this.currentPosition=d.display_name,this.isLocationLoading=!1})})}ngOnInit(){}getAllSpecs(){this.specService.getSpecialites().subscribe(n=>{this.allSpecs=n.specialites,this.specOptions=this.allSpecs})}getRecommandations(){let n=this.latitude.toString(),i=this.longitude.toString(),c=this.emergencyForm.get("specialite").value,l=this.specOptions.find(m=>m.name==c).id;this.recommandationService.getRecommandation(n,i,l).subscribe(m=>{this.recommandations=m.recommandations,console.log(this.recommandations),this.mapLink=this.sanitizer.bypassSecurityTrustResourceUrl(`https://maps.google.com/maps?q=${this.recommandations[0].hopital.addresse.lat},${this.recommandations[0].hopital.addresse.lon}&hl=fr&z=14&amp&output=embed`)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(Z.H7),t.Y36(S.O),t.Y36(a.qu),t.Y36(A.R),t.Y36(U))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-recommandation"]],decls:7,vars:2,consts:[[1,"container"],["class","loading",4,"ngIf"],["class","body",4,"ngIf"],[1,"loading"],["diameter","50"],[1,"body"],[1,"left"],["class","location",4,"ngIf"],[1,"emergencyFormContainer"],[1,"emergencyForm",3,"formGroup"],["appearance","fill"],["type","text","placeholder","nom","matInput","","formControlName","patient"],["type","text","matInput","","formControlName","specialite",3,"matAutocomplete"],["specAuto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["mat-button","",1,"rechercher",3,"click"],["class","right",4,"ngIf"],[1,"location"],[1,"icon",3,"icon"],[3,"value"],[1,"right"],[1,"carte",3,"src"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"URGENCES"),t.qZA(),t.TgZ(3,"h3"),t._uU(4,"S\xe9lectionnez le cas d'urgence dans la liste ci dessous et vous serew dirig\xe9 vers l'h\xf4pital le plus proche en capacit\xe9 d'accueil "),t.qZA(),t.YNc(5,T,2,0,"div",1),t.YNc(6,J,19,5,"div",2),t.qZA()),2&n&&(t.xp6(5),t.Q6J("ngIf",i.isLocationLoading),t.xp6(1),t.Q6J("ngIf",!i.isLocationLoading))},dependencies:[p.sg,p.O5,h.BN,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,u.KE,u.hX,F.ey,v.lW,x.Ou,g.XC,g.ZL,C.Nt],styles:[".container[_ngcontent-%COMP%]{margin:1em;display:flex;flex-direction:column;justify-content:center;align-items:center}h1[_ngcontent-%COMP%]{color:red}.body[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;grid-column-gap:1em!important;justify-content:center;align-items:center}.left[_ngcontent-%COMP%]{border-radius:.3em;padding:1em}.location[_ngcontent-%COMP%]{background-color:#f9d5da;padding:1em;border-radius:.3em;border:1px solid red;color:red;display:flex;flex-direction:row;justify-content:center;align-items:center}.emergencyFormContainer[_ngcontent-%COMP%]{border:1px solid red;border-radius:.3em;padding:1em;display:flex;flex-direction:column;margin:1em 0}.emergencyForm[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:stretch;align-items:stretch}.rechercher[_ngcontent-%COMP%]{color:#fff;background-color:red;transition:all .2s}.rechercher[_ngcontent-%COMP%]:hover{transform:scale(1.05);color:#fff}.right[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;border:1px solid red;padding:1em;border-radius:.3em}.carte[_ngcontent-%COMP%]{width:100%;height:50vh}"]}),e})();var N=o(9347),b=o(5113);const Y=[{path:"",component:P}];let Q=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.ez,h.uH,a.UX,b.LD,u.lN,v.ot,x.Cq,g.Bb,C.c,N.Bz.forChild(Y)]}),e})()}}]);